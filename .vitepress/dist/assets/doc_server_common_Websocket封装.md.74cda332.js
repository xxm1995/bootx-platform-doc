import{_ as n,c as s,o as a,a as t}from"./app.baff2d89.js";const _='{"title":"\u529F\u80FD","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u529F\u80FD","slug":"\u529F\u80FD"},{"level":2,"title":"\u4F7F\u7528\u8BF4\u660E","slug":"\u4F7F\u7528\u8BF4\u660E"}],"relativePath":"doc/server/common/Websocket\u5C01\u88C5.md"}',p={},o=t(`<h2 id="\u529F\u80FD" tabindex="-1">\u529F\u80FD <a class="header-anchor" href="#\u529F\u80FD" aria-hidden="true">#</a></h2><ul><li>\u63D0\u4F9B\u539F\u751F<code>Websocket</code> \u548C <code>SpringWebsocker</code>\u7684\u8FDE\u63A5\u7BA1\u7406\u5668\uFF0C\u65B9\u4FBF\u7BA1\u7406\u4F1A\u8BDD\u4E0E\u7528\u6237\u4E4B\u95F4\u7684\u5173\u7CFB</li><li>\u53EF\u4EE5\u914D\u7F6E\u4F7FWebsocket\u53EA\u6709\u767B\u5F55\u72B6\u6001\u4E0B\u624D\u53EF\u4EE5\u8FDE\u63A5</li><li>\u63D0\u4F9B\u591A\u79CD\u5230\u524D\u53F0\u7684\u901A\u77E5\u65B9\u5F0F\uFF0C\u5982\u901A\u77E5\u6846\u6D88\u606F\uFF0C\u4E8B\u4EF6\u901A\u77E5\u7B49</li><li>\u63D0\u4F9B\u7528\u6237\u5168\u5C40\u7EA7\u522B\u7684<code>Websocket</code> \u670D\u52A1\uFF0C\u65B9\u4FBFws\u6D88\u606F\u63A8\u9001</li><li>\u524D\u7AEF\u5C01\u88C5\u7528\u6237\u5168\u5C40\u6D88\u606F\u901A\u77E5\u7684<code>Websocket</code>\u548C \u5BF9\u5E94\u7684\u4E8B\u4EF6\u603B\u7EBF\uFF0C\u901A\u8FC7\u76D1\u542C\u6307\u5B9A\u4E8B\u4EF6\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u5C06\u524D\u53F0\u6D88\u606F\u63A8\u9001\u5230\u4E0D\u540C\u7684\u9875\u9762\u4E2D</li></ul><h2 id="\u4F7F\u7528\u8BF4\u660E" tabindex="-1">\u4F7F\u7528\u8BF4\u660E <a class="header-anchor" href="#\u4F7F\u7528\u8BF4\u660E" aria-hidden="true">#</a></h2><p><strong>\u540E\u53F0\u914D\u7F6E</strong> \u767B\u5F55\u540E\u53F0\uFF0C\u5728<code>\u7CFB\u7EDF\u914D\u7F6E</code>\u4E2D<code>\u7CFB\u7EDF\u53C2\u6570</code>\u91CC\u914D\u7F6E <code>websocket\u670D\u52A1\u5668\u5730\u5740</code><strong>\u540E\u7AEF\u6D88\u606F\u63A8\u9001</strong> \u6CE8\u5165<code>UserWsNoticeService</code>\u670D\u52A1\uFF0C\u8C03\u7528\u5BF9\u5E94\u65B9\u6CD5\u8FDB\u884C\u6D88\u606F\u7684\u63A8\u9001\uFF0C\u901A\u8FC7<code>WsRes</code>\u5DE5\u5177\u7C7B,\u53EF\u4EE5\u4FBF\u6377\u7684\u521B\u5EFA</p><div class="language-java"><pre><code><span class="token annotation punctuation">@Operation</span><span class="token punctuation">(</span>summary <span class="token operator">=</span> <span class="token string">&quot;\u7528\u6237\u5168\u5C40ws\u6D88\u606F\u901A\u77E5\u6D4B\u8BD5&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/userNotice&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">userNotice</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// \u63A8\u9001\u6D88\u606F\u901A\u77E5\u6846</span>
    <span class="token class-name">WsResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token class-name">WsRes</span><span class="token punctuation">.</span><span class="token function">notificationError</span><span class="token punctuation">(</span><span class="token string">&quot;\u8B66\u544A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userWsNoticeService<span class="token punctuation">.</span><span class="token function">sendMessageByUser</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u63A8\u9001\u6D88\u606F\u4E8B\u4EF6(\u901A\u5E38\u7531\u6307\u5B9A\u9875\u9762\u8FDB\u884C\u76D1\u542C)</span>
    result <span class="token operator">=</span> <span class="token class-name">WsRes</span><span class="token punctuation">.</span><span class="token function">eventNotice</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userWsNoticeService<span class="token punctuation">.</span><span class="token function">sendMessageByUser</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Res</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>\u524D\u7AEF\u9875\u9762\u76D1\u542C\u901A\u77E5\u4E8B\u4EF6</strong> \u524D\u7AEF\u6D88\u606F\u603B\u7EBF\u4F7F\u7528\u7684 <code>vue-bus</code>\uFF0C\u524D\u7AEFwebsocket\u5BA2\u6237\u7AEF\u63A5\u5230\u4E8B\u4EF6\u540E\uFF0C\u53D1\u9001\u5230\u6D88\u606F\u603B\u7EBF\u4E2D\uFF0C\u7531\u5BF9\u5E94\u7684\u9875\u9762\u8FDB\u884C\u76D1\u542C\uFF0C\u7528\u6237\u9000\u51FA\u65F6\u4F1A\u81EA\u52A8\u65AD\u5F00\u5BF9\u5E94\u7684Websock\u8FDE\u63A5</p><div class="language-java"><pre><code>created <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// \u9875\u9762\u521B\u5EFA\u76D1\u542C</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token char">&#39;cs&#39;</span><span class="token punctuation">,</span> data <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>&#39;\u4E8B\u4EF6\u603B\u7EBF\u63A5\u6536\u6D88\u606F&#39;<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
destroyed <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u9875\u9762\u5173\u95ED\u65F6\u89E3\u9664\u76D1\u542C</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$bus<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token char">&#39;cs&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>`,7),e=[o];function c(u,l,i,k,r,d){return a(),s("div",null,e)}var m=n(p,[["render",c]]);export{_ as __pageData,m as default};
