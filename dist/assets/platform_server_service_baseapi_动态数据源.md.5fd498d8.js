import{_ as s,o as a,c as o,X as t}from"./chunks/framework.6909765d.js";const e="/assets/4.762afd93.png",n="/assets/5.bccf434c.png",h=JSON.parse('{"title":"动态数据源","description":"","frontmatter":{},"headers":[],"relativePath":"platform/server/service/baseapi/动态数据源.md","filePath":"platform/server/service/baseapi/动态数据源.md"}'),l={name:"platform/server/service/baseapi/动态数据源.md"},p=t('<h1 id="动态数据源" tabindex="-1">动态数据源 <a class="header-anchor" href="#动态数据源">¶</a></h1><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>基于 <a href="https://gitee.com/baomidou/dynamic-datasource-spring-boot-starter" target="_blank" rel="noreferrer">dynamic-datasource</a>实现多数据源管理，所拥有的特性取决于<code>dynamic-datasource</code>的支持下。 它对应的付费文档地址为：<a href="https://www.kancloud.cn/tracy5546/dynamic-datasource/2264611" target="_blank" rel="noreferrer">云文档</a>。</p><p>动态数据源推荐用于一些数据库连接地址容易出现变动的场合，例如与第三方系统进行表同步，临时对数据进行取数等操作，如果是长期不变的，尤其是系统锁依赖的业务库，推荐在配置文件中进行配置，</p></div><h2 id="截图" tabindex="-1">截图 <a class="header-anchor" href="#截图">¶</a></h2><p><strong>新增或更新</strong></p><blockquote><p>数据源编码是唯一的，并且编码必须以字母开头，可包含数字、下划线、横杠。</p></blockquote><p><img src="'+e+'" alt="img.png"></p><p><strong>数据源列表</strong></p><blockquote><p>用来查看当前系统已经加载的数据源列表，可以进行动态的删除，注意主数据源无法被删除。</p></blockquote><p><img src="'+n+`" alt="img_1.png"></p><h2 id="数据源管理" tabindex="-1">数据源管理 <a class="header-anchor" href="#数据源管理">¶</a></h2><table><thead><tr><th>属性或操作</th><th>备注</th></tr></thead><tbody><tr><td>编码</td><td>该动态数据源的唯一标识，不可以重复</td></tr><tr><td>名称</td><td></td></tr><tr><td>数据库类型</td><td></td></tr><tr><td>自动加载</td><td></td></tr><tr><td>驱动类</td><td>若回显的驱动类和数据源地址与你的数据库版本不一致，可自行修改</td></tr><tr><td>数据库地址</td><td></td></tr><tr><td>用户名</td><td></td></tr><tr><td>测试连接</td><td>对填写的数据库连接信息进行测试</td></tr></tbody></table><h2 id="使用说明" tabindex="-1">使用说明 <a class="header-anchor" href="#使用说明">¶</a></h2><blockquote><p>基于<code>dynamic-datasource</code>简单叙述一下，多数据源在系统中如何进行使用</p></blockquote><p><strong>配置文件配置多数据源</strong></p><blockquote><p>master 为主数据源，系统默认数据源</p></blockquote><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">datasource</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#F07178;">datasource</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">master</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">jdbc:mysql://127.0.0.1:3306/bootx-platform?characterEncoding=UTF-8&amp;useUnicode=true&amp;useSSL=false</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">username</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">driver-class-name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.mysql.jdbc.Driver</span><span style="color:#A6ACCD;">   </span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">multi-datasource1</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">jdbc:mysql://localhost:3306/bootx-flowable?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull&amp;transformedBitIsBoolean=true</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">username</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">driver-class-name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.mysql.jdbc.Driver</span></span></code></pre></div><p><strong>动态数据源切换</strong></p><ul><li>使用<code>@DS</code>注解切换数据源，将该注解添加到方法或者类上，自动就可以进行切换。</li><li>手动切换数据源，通过调用<code>DynamicDataSourceContextHolder</code>下的方法进行手动的切换数据源。</li><li>使用<code>filter</code>过滤器或<code>intercepror</code>拦截器进行切换，底层基于<code>DynamicDataSourceContextHolder.push</code>进行切换</li><li>使用AOP切面进行切换，底层基于<code>DynamicDataSourceContextHolder.push</code>进行切换</li></ul><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项">¶</a></h2><p>多数据源会涉及到分布式事务问题，同时与<code>@Transational</code>一起使用就有可能出现切换数据源失败问题，需要进行特别注意，详情可以阅读<code>dynamic-datasource</code>的付费文档。</p>`,20),r=[p];function c(d,i,y,D,C,m){return a(),o("div",null,r)}const A=s(l,[["render",c]]);export{h as __pageData,A as default};
